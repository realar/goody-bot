{% extends "base.html" %}
{% block content %}
<div class="content">
    <h2>Каталог компаний</h2>
    <div id="company-list" class="company-list">
        <p>Загрузка данных...</p>
    </div>
</div>

<script>
    async function fetchCompanies() {
        try {
            const response = await fetch('{{ url_for("webapp.get_companies") }}');
            if (!response.ok) {
                throw new Error(`Ошибка загрузки: ${response.statusText}`);
            }
            const companies = await response.json();
            renderCompanies(companies);
        } catch (error) {
            document.getElementById('company-list').innerHTML = `<p>Ошибка загрузки данных: ${error.message}</p>`;
        }
    }

    function renderCompanies(companies) {
        const container = document.getElementById('company-list');
        container.innerHTML = '';
        if (companies.length === 0) {
            container.innerHTML = '<p>Компании не найдены.</p>';
            return;
        }
        companies.forEach(company => {
            const companyElement = document.createElement('div');
            companyElement.classList.add('company');
            companyElement.innerHTML = `
                <div class="company-name">${company.name}</div>
                <div class="company-description">${company.description}</div>
            `;
            container.appendChild(companyElement);
        });
    }

    // Загружаем данные при загрузке страницы
    fetchCompanies();
</script>

<style>
    .company-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }
    .company {
        padding: 10px;
        background-color: #f0f0f0;
        border: none;
        border-radius: 8px;
    }
    .company-name {
        font-weight: bold;
        font-size: 16px;
    }
    .company-description {
        font-size: 14px;
        color: #555;
    }
</style>
{% endblock %}
